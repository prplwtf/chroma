(function(M,u){typeof exports=="object"&&typeof module<"u"?module.exports=u():typeof define=="function"&&define.amd?define(u):(M=typeof globalThis<"u"?globalThis:M||self,M.Chroma=u())})(this,function(){"use strict";var G=Object.defineProperty;var J=(M,u,k)=>u in M?G(M,u,{enumerable:!0,configurable:!0,writable:!0,value:k}):M[u]=k;var O=(M,u,k)=>J(M,typeof u!="symbol"?u+"":u,k);function M(s){if(document.getElementById(`${s.id}-helper`)!=null)return;const c=document.createElement("div");s.parentNode.insertBefore(c,s.nextSibling),c.id=`${s.id}-helper`,c.setAttribute("_chroma","picker"),c.innerHTML=`
    <div>
      <canvas _chroma="picker:spectrum" width="200" height="200"></canvas>
      <canvas _chroma="picker:hue" width="30" height="200"></canvas>
    </div>
  `;const m=c.querySelector('[_chroma="picker:spectrum"]'),f=c.querySelector('[_chroma="picker:hue"]');let E=!1,C=!1,S={r:255,g:0,b:0},y=0,d=0,l=0,g,x=0,p=0,v=0,A=0;const j=300,z=600;let T=0,Y=0,I=!1;const H=s.value;if(H.match(/^#[0-9A-Fa-f]{6}$/)){const t=parseInt(H.substring(1,3),16),e=parseInt(H.substring(3,5),16),n=parseInt(H.substring(5,7),16),{h:i,s:r,v:o}=q(t,e,n);y=i,d=r,l=1-o,x=i,p=r,v=1-o,S=L(y)}s.style.setProperty("--chroma-data-computedwidth",c.offsetWidth+"px"),D(),F();function D(){const t=f.getContext("2d");t.clearRect(0,0,f.width,f.height);for(let e=0;e<f.height;e++){const n=e/f.height,i=L(n);t.fillStyle=`rgb(${i.r}, ${i.g}, ${i.b})`,t.fillRect(0,e,f.width,1)}W()}function W(){const t=f.getContext("2d");t.fillStyle="white",t.fillRect(0,y*f.height-1.5,f.width,3)}function L(t){t*=6;const e=Math.floor(t),n=t-e;switch(e){case 0:return{r:255,g:Math.round(n*255),b:0};case 1:return{r:Math.round((1-n)*255),g:255,b:0};case 2:return{r:0,g:255,b:Math.round(n*255)};case 3:return{r:0,g:Math.round((1-n)*255),b:255};case 4:return{r:Math.round(n*255),g:0,b:255};case 5:return{r:255,g:0,b:Math.round((1-n)*255)};default:return{r:255,g:0,b:0}}}function F(){const t=m.getContext("2d"),e=m.width,n=m.height,i=t.createImageData(e,n),r=i.data;for(let o=0;o<e;o++)for(let h=0;h<n;h++){const b=(h*e+o)*4,a=o/e,w=1-h/n;r[b]=Math.round(S.r*a*w+(1-a)*255*w),r[b+1]=Math.round(S.g*a*w+(1-a)*255*w),r[b+2]=Math.round(S.b*a*w+(1-a)*255*w),r[b+3]=255}t.putImageData(i,0,0),K()}function K(){const t=m.getContext("2d"),e=d*m.width,n=l*m.height;t.beginPath(),t.arc(e,n,4,0,2*Math.PI),t.strokeStyle=l>.5?"white":"black",t.lineWidth=2,t.stroke()}function P(t){A||(A=t);const e=t-A,n=o=>o<.5?2*o*o:-1+(4-2*o)*o;let i=!0,r=!0;if(p!==d||v!==l){const o=Math.min(e/j,1);d=d+(p-d)*n(o),l=l+(v-l)*n(o),i=o===1}if(x!==y){const o=Math.min(e/z,1);y=y+(x-y)*n(o),S=L(y),r=o===1}x!==y&&D(),F(),!i||!r?g=requestAnimationFrame(P):A=0}const X=()=>{g&&cancelAnimationFrame(g),s.style.removeProperty("--chroma-data-computedwidth"),document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",R),document.removeEventListener("click",_),document.removeEventListener("keydown",$)},_=t=>{!c.contains(t.target)&&t.target!==s&&(X(),c.remove())},$=t=>{t.key==="Escape"&&(X(),c.remove())},N=t=>{(E||C)&&(Math.abs(t.clientX-T)>1||Math.abs(t.clientY-Y)>1)&&(I=!0),E&&B(t,!1),C&&U(t,!1)},R=t=>{E&&(E=!1,B(t,!I)),C&&(C=!1,U(t,!I))};document.addEventListener("click",_),document.addEventListener("keydown",$),document.addEventListener("mousemove",N),document.addEventListener("mouseup",R);function q(t,e,n){t/=255,e/=255,n/=255;const i=Math.max(t,e,n),r=Math.min(t,e,n);let o,h,b=i;const a=i-r;if(h=i===0?0:a/i,i===r)o=0;else{switch(i){case t:o=(e-n)/a+(e<n?6:0);break;case e:o=(n-t)/a+2;break;case n:o=(t-e)/a+4;break}o/=6}return{h:o,s:h,v:b}}s.addEventListener("input",t=>{if(t.target.value.match(/^#[0-9A-Fa-f]{6}$/)){const e=t.target.value.substring(1),n=parseInt(e.substring(0,2),16),i=parseInt(e.substring(2,4),16),r=parseInt(e.substring(4,6),16);s.previousElementSibling.style.backgroundColor=t.target.value,s.style.setProperty("--chroma-data-color",t.target.value);const{h:o,s:h,v:b}=q(n,i,r);x=o,p=h,v=1-b,g&&cancelAnimationFrame(g),A=0,g=requestAnimationFrame(P)}}),m.addEventListener("mousedown",t=>{E=!0,I=!1,T=t.clientX,Y=t.clientY}),f.addEventListener("mousedown",t=>{C=!0,I=!1,T=t.clientX,Y=t.clientY});function B(t,e=!0){const n=m.getBoundingClientRect(),i=(t.clientX-n.left)/m.width,r=(t.clientY-n.top)/m.height;p=Math.max(0,Math.min(1,i)),v=Math.max(0,Math.min(1,r));const o=Math.round(S.r*p*(1-v)+(1-p)*255*(1-v)),h=Math.round(S.g*p*(1-v)+(1-p)*255*(1-v)),b=Math.round(S.b*p*(1-v)+(1-p)*255*(1-v)),a="#"+[o,h,b].map(w=>w.toString(16).padStart(2,"0")).join("");s.value=a,s.previousElementSibling.style.backgroundColor=a,s.style.setProperty("--chroma-data-color",a),e?(g&&cancelAnimationFrame(g),A=0,g=requestAnimationFrame(P)):(d=p,l=v,F())}function U(t,e=!0){const n=f.getBoundingClientRect(),i=(t.clientY-n.top)/f.height;x=Math.max(0,Math.min(1,i));const r=L(x),o=Math.round(r.r*d*(1-l)+(1-d)*255*(1-l)),h=Math.round(r.g*d*(1-l)+(1-d)*255*(1-l)),b=Math.round(r.b*d*(1-l)+(1-d)*255*(1-l)),a="#"+[o,h,b].map(w=>w.toString(16).padStart(2,"0")).join("");s.value=a,s.previousElementSibling.style.backgroundColor=a,s.style.setProperty("--chroma-data-color",a),e?(g&&cancelAnimationFrame(g),A=0,g=requestAnimationFrame(P)):(y=x,S=r,D(),F())}}const k=class k{constructor(c,m={}){this.element=document.querySelector(c),this.options={...k.defaults,...m},this.init()}init(){console.log("Initializing on",this.element),this.element.setAttribute("_chroma","input");const c=document.createElement("label");return c.setAttribute("_chroma","input"),this.element.id||(this.element.id=`chroma-input-${Math.random().toString(36).substr(2,9)}`),c.setAttribute("for",this.element.id),this.element.parentNode.insertBefore(c,this.element),this.element.value||(this.element.value=this.options.initialColor),this.element.value.match(/^#[0-9A-Fa-f]{6}$/)&&(c.style.backgroundColor=this.element.value,this.element.style.setProperty("--chroma-data-color",this.element.value)),this.element.addEventListener("click",()=>{M(this.element)}),[]}};O(k,"defaults",{initialColor:"#000000"});let u=k;return u});
